# REST API

## User

| CRUD   | Endpoint                   | Parameters | Headers        | Body                                                | Description                                | Response                                                                                         | Possible Errors                                  |
|--------|----------------------------|------------|----------------|-----------------------------------------------------|--------------------------------------------|-------------------------------------------------------------------------------------------------|-------------------------------------------------|
| GET    | /api/user/getUserDetails    | -          | userId: string | -                                                   | Returns user details by ID                  | ```json { "title": "Success", "message": "User details fetched successfully.", "data": { "id": "string", "first_name": "string", "last_name": "string", "phone": "string", "address": "string", "profilePicture": "string", "role": "string", "authMethod": "string", "location": { "latitude": number, "longitude": number }, "loved_Hotels": {}, "created_at": "date" } }``` | 400 - Missing userId<br>404 - User not found<br>500 - Server error |
| POST   | /api/user/addOrUpdateUser   | -          | userId: string | <pre>{ "first_name": "string", "last_name": "string", "phone"?: "string", "address"?: "string", "profile_picture"?: "string" }</pre> | Creates a new user or updates existing user by ID | <pre>1. { "message": "User added successfully", "userId": "newUserId" }<br>2. { "message": "User updated successfully" }</pre> | 400 - Missing required fields<br>400 - Error adding/updating user<br>500 - Server error |
| PATCH  | /api/user/favorites/        | -          | userId: string | <pre>{ "hotelId": "string", "action": "add" or "remove" }</pre> | Updates user's favorite hotels list (add or remove) | <pre>{ "title": "Success", "message": "Loved hotels updated successfully.", "hotelId": "string", "action": "add" or "remove", "updatedList": ["string"], "userId": "string" }</pre> | 400 - Missing hotelId or action<br>400 - Illegal action (not "add" or "remove")<br>404 - User or hotel not found<br>400/500 - Server or database error |
| DELETE | /api/user/:userId           | userId: string | userId: string | -                                                   | Deletes user by ID                          | ```json { "title": "Success", "message": "User deleted successfully." }```                         | 400 - Missing userId<br>404 - User not found<br>430 - Unauthorized to delete user<br>500 - Server error |

## Auth

| CRUD   | Endpoint                   | Parameters    | Headers | Body                                          | Description                   | Response                                                                                         | Possible Errors                                               |
|--------|----------------------------|---------------|---------|-----------------------------------------------|-------------------------------|-------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
| GET    | /api/auth/getOTP/:email     | email: string | -       | -                                             | Sends an OTP code to the provided email | ```json { "title": "OTP Sent", "message": "A one-time password has been sent to your email address." }``` | 400 - Missing email address<br>500 - Failed to save OTP to DB<br>500 - Failed to send OTP email<br>500 - Server error |
| POST   | /api/auth/verifyOTP/        | -             | -       | ```json { "email": "string", "otp": "string" }``` | Verifies the sent OTP code      | ```json { "title": "OTP Verified", "message": "Verification successful. You may continue." }```  | 400 - Missing parameters<br>404 - OTP not found<br>401 - Invalid OTP<br>410 - OTP expired<br>500 - Failed to delete OTP<br>500 - Server error |

## Search History

| CRUD   | Endpoint                      | Parameters | Headers  | Body                          | Description                                  | Response                                                                                     | Possible Errors                                  |
|--------|-------------------------------|------------|----------|-------------------------------|----------------------------------------------|-----------------------------------------------------------------------------------------------|-------------------------------------------------|
| POST   | /api/searchHistory/addSearch   | -          | userId   | ```json { "query": "string" }``` | Adds a new search for the user (if not already exists) | ```json { "title": "Success", "message": "Search saved successfully." }```                   | 400 - Missing required fields<br>409 - Search already exists<br>500 - Server error |
| GET    | /api/searchHistory/getUserSearches | -      | userId   | -                             | Returns all user searches ordered by time descending | ```json { "title": "Success", "message": "User searches fetched successfully.", "data": ["query1", "query2", "..."] }``` | 400 - Missing userId<br>404 - No searches found<br>500 - Server error |
| GET    | /api/searchHistory/getSearchSuggestions | - | -        | ```json { "query": "string" }``` | Searches for suggestions based on partial text | ```json { "title": "Success", "message": "User searches fetched successfully.", "data": ["suggestion1", "suggestion2", "..."] }``` | 400 - Missing query field<br>404 - No suggestions found<br>500 - Server error |
